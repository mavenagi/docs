---
title: Salesforce Legacy Chat REST API
slug: /apps/chat/live-agent-handoff/salesforce-legacy
---

<Warning>Salesforce has [deprecated](https://help.salesforce.com/s/articleView?id=release-notes.rn_chat_retirement.htm&release=250&type=5) the legacy Chat REST API and recommends migrating to the Salesforce Messaging for In-App and Web API.</Warning>

Maven Chat integrates with Salesforce Live Agent to provide human support capabilities. This integration requires configuration in both Salesforce and Maven.

## Requirements

- Salesforce account with Live Agent enabled
- Access to Salesforce Setup
- A configured Live Agent deployment and button

## Setup Process

Follow these steps to configure Salesforce integration:

<Steps>
  <Step title="Configure Live Agent Deployment">
    - Navigate to **Salesforce Setup > Embedded Service Deployments**
    - Locate or create a new deployment
    - Note the **Deployment ID** and **ES Live Agent Dev Name**
  </Step>
  <Step title="Configure Chat Button">
    - Navigate to **Setup > Chat Buttons & Invitations**
    - Create or select an existing chat button
    - Note the **Button ID**
  </Step>
  <Step title="Locate Live Agent Settings">
    - Navigate to **Salesforce Setup > Live Agent Settings**
    - Note your **Chat Host URL**
  </Step>
  <Step title="Locate Organization ID">
    - Navigate to **Salesforce Setup > Organization Settings**
    - Note your **Organization ID**
  </Step>
</Steps>

## Configuration

Create a handoff configuration object with the following structure:

<Steps>
  <Step title="Create Configuration Object">
    Create your configuration object:
```javascript
{
  type: 'salesforce',
  orgId: 'your-org-id',
  chatHostUrl: 'https://d.la12s-core1.sfdc-lywfpd.salesforceliveagent.com',
  chatButtonId: 'your-button-id',
  deploymentId: 'your-deployment-id',
  eswLiveAgentDevName: 'your-live-agent-name',
  apiSecret: 'your-api-secret',
  allowAnonymousHandoff: false,
  enableAvailabilityCheck: false
}
```
  </Step>
  <Step title="Convert to JSON and add to Maven">
    - Convert the object to a JSON string
    - Enter it in the **Live agent handoff configuration** field in chat app settings
  </Step>
</Steps>

### Configuration Options

| Option | Type | Required | Default | Description |
|--------|------|----------|---------|-------------|
| `type` | 'salesforce' | Yes | - | Identifies Salesforce as the handoff provider |
| `orgId` | string | Yes | - | Your Salesforce organization ID |
| `chatHostUrl` | string | Yes | - | Your Salesforce Live Agent server URL |
| `chatButtonId` | string | Yes | - | Your Salesforce chat button ID |
| `deploymentId` | string | Yes | - | Your Salesforce deployment ID |
| `eswLiveAgentDevName` | string | Yes | - | Your Embedded Service Live Agent name |
| `apiSecret` | string | Yes | - | Authentication secret for handoff requests |
| `allowAnonymousHandoff` | boolean | No | false | Whether to request email from anonymous users |
| `surveyLink` | string | No | - | Post-handoff survey URL |
| `enableAvailabilityCheck` | boolean | No | false | Whether to check agent availability |
| `availabilityFallbackMessage` | string | No | - | Message shown when agents unavailable |

## Customizing LiveChatTranscript Creation

You can customize the Salesforce request to create a LiveChatTranscript by adding a `chasitorConfiguration` object to your Salesforce handoff configuration. This lets you define which fields, entities, and associated records are included in the pre-chat transcript, and how their values are setâ€”either statically or dynamically from runtime sources. For example, you can search for existing Salesforce contacts and associate their contact record with the transcript. You can also automatically create and associate case records with custom fields like Subject.

**How it works:**
- `chasitorConfiguration` lives on your Salesforce handoff configuration object.
- It controls which fields (`prechatDetails`) and Salesforce entities (`prechatEntities`) are included in the chat session initialization request, and how their values are determined.
- To set a static value, use the `value` property in a `prechatDetail`.
- To set a dynamic value, use the `valueFrom` property (omit `value`).

**Available `valueFrom` sources:**
- `customField`: Values from custom fields provided in the handoff request.
- `user`: Values from the user data object (the user data depends on whether a signed user authentication token is provided).
- `session`: Values from the Salesforce chat session credentials object (e.g., session key or ID).
- `configuration`: Values from the handoff configuration itself.
- `conversation`: Values from the Maven conversation (currently, this is only the conversation ID).

The `id` property specifies the key or field name to extract from the chosen source.

**Example:**

```javascript
const handoffConfiguration = {
  // ...other Salesforce handoff config...
  chasitorConfiguration: {
    prechatDetails: [
      // Static value
      {
        label: "Origin",
        value: "Web Chat",
        displayToAgent: false,
        transcriptFields: ["Origin__c"],
      },
      // Dynamic value from user data
      {
        label: "Email",
        valueFrom: { type: "user", id: "email" },
        displayToAgent: true,
        transcriptFields: ["Email"],
      },
      // Dynamic value from a custom field
      {
        label: "Order Number",
        valueFrom: { type: "customField", id: "orderNumber" },
        displayToAgent: true,
        transcriptFields: ["Order_Number__c"],
      },
    ],
    prechatEntities: [
      // Create or link a Contact
      {
        entityName: "Contact",
        showOnCreate: true,
        saveToTranscript: "ContactId",
        entityFieldsMaps: [
          {
            fieldName: "Email",
            label: "Email",
            doCreate: true,
            doFind: true,
            isExactMatch: true,
          },
        ],
      },
      // Create a Case associated with the Contact
      {
        entityName: "Case",
        showOnCreate: true,
        linkToEntityName: "Contact",
        linkToEntityField: "ContactId",
        saveToTranscript: "CaseId",
        entityFieldsMaps: [
          {
            fieldName: "Origin",
            label: "Origin",
            doCreate: true,
            doFind: false,
            isExactMatch: false,
          },
          {
            fieldName: "Order_Number__c",
            label: "Order Number",
            doCreate: true,
            doFind: false,
            isExactMatch: false,
          },
        ],
      },
    ],
  },
};
```

In this example:
- `Origin` is set statically.
- `Email` is dynamically pulled from the user object.
- `Order Number` is dynamically pulled from a custom field in the handoff request.
- Both a Contact and a Case are created/linked and associated with the chat transcript.

Edit the `valueFrom` sources and field mappings as needed to match your data model and integration needs.

