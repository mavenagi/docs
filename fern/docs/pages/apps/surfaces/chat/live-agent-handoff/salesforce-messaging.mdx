---
title: Salesforce Messaging for In-App and Web
slug: /apps/chat/live-agent-handoff/salesforce-messaging
---

Maven Chat supports Messaging for In-App and Web. This integration requires configuration in both Maven and Salesforce.

## Requirements

- Salesforce account with Messaging for In-App and Web enabled
- Access to Salesforce Setup
- A configured Messaging for In-App and Web deployment

## Setup Process

<Note>Configuration of basic Salesforce settings is outside the scope of this guide.</Note>

<Steps>
  <Step title="Create an Embedded Service deployment">
    - Navigate to **Salesforce Setup > Feature Settings > Service > Embedded Service**
    - Create a new deployment
    - Select **Messaging for In-App and Web** when prompted
    - Select **Custom Client** when prompted
    - Enter a name for the deployment (API Name will be auto-generated) and select the correct messaging channel
    - Click **Save**
    - Click **Publish** (may take a few minutes to publish)
  </Step>
  <Step title="Retrieve deployment configuration details">
    - Click on **Install Code Snippet**
    - Record the **OrganizationId, DeveloperName, and Url** values
  </Step>
</Steps>

## Configuration

Create a handoff configuration object with the following structure:

<Steps>
  <Step title="Create your configuration object">
    ```javascript
    {
      type: 'salesforce-messaging',
      organizationId: 'your-organization-id',
      messagingUrl: 'https://your-messaging-url.my.salesforce-scrt.com/',
      deploymentId: 'your-developer-name',
      apiSecret: 'a-random-32-byte-string', // used for signing access tokens for chat sessions
    }
    ```
  </Step>
  <Step title="Convert to JSON and add to Maven">
    - Convert the object to a JSON string
    - Enter it in the **Live agent handoff configuration** field in chat app settings
  </Step>
</Steps>

### Configuration Options

| Option | Type | Required | Default | Description |
|--------|------|----------|---------|-------------|
| `type` | 'salesforce-messaging' | Yes | - | Identifies Salesforce as the handoff provider |
| `organizationId` | string | Yes | - | Your Salesforce organization ID |
| `messagingUrl` | string | Yes | - | Your Salesforce Messaging for In-App and Web URL |
| `deploymentId` | string | Yes | - | Your Salesforce deployment ID |
| `apiSecret` | string | Yes | - | Authentication secret for handoff requests |
| `allowAnonymousHandoff` | boolean | No | false | Whether to request email from anonymous users |
| `surveyLink` | string | No | - | Post-handoff survey URL |
| `prechatFieldMap` | `Record<string, { label?: string; description?: string; signedDataPropertyName?: string; }>` | No | - | Customize pre-chat fields |

## Importing and Customizing Pre-Chat Fields

Chat supports rendering Salesforce Messaging pre-chat fields on the escalation form and passing them back to Salesforce in the `routingAttributes` object when a live agent session is initiated.

### How it works

- Automatically imports [pre-chat fields](https://help.salesforce.com/s/articleView?id=service.miaw_custom_prechat_3.htm&type=5) configured in your Salesforce Messaging deployment.
- Renders the fields in the live agent escalation form within chat UI.
- Supports customization using the `prechatFieldMap` property in the **Live agent handoff configuration** object.
- Supports LLM-generated suggestions for field values.
- User data can be pulled from the signed user authentication token instead of requiring user input in the form.
- When escalation occurs, the selected and/or auto-filled field values are passed to Salesforce as `routingAttributes` in the [createConversation API](https://developer.salesforce.com/docs/service/messaging-api/references/miaw-api-reference?meta=createConversation).

### `prechatFieldMap` configuration

The optional `prechatFieldMap` object allows you to customize labels, descriptions, and automatically populate field values from signed user data.

Each key in the map corresponds to the Salesforce pre-chat field name (case-sensitive). You can:

- Override the field's label shown in the escalation form
- Add a user-facing description below the field
- Populate the field using a property from the signed user data (use `signedDataPropertyName`)

### Example

```json
{
  "type": "salesforce-messaging",
  ...
  "prechatFieldMap": {
    "_email": {
      "signedDataPropertyName": "email"
    },
    "_orderNumber": {
      "label": "Order Number",
      "description": "The order number should be 10 digits long"
    }
  }
}
```

With this setup, the chat widget will:
- Omit the email field from the escalation form
- Automatically populate the email field with the value from the `email` property of the signed user data
- Provides custom label and description for the order number field
- Send both values to Salesforce as `routingAttributes` during escalation

